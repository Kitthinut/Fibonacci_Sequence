<script>
function drawGoldenRatioSpiral() {
    const input = document.getElementById("fibInput");
    let n = parseInt(input.value);
    if (isNaN(n) || n < 1) n = 10;
    if (n > 20) n = 20; // fewer for visual clarity

    const fib = fibonacci(n); // Fibonacci sequence

    const container = document.getElementById("spiral");
    const canvas = document.getElementById("spiralCanvas");
    const ctx = canvas.getContext("2d");

    container.innerHTML = "";
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;

    let x = centerX;
    let y = centerY;
    let angle = 0; // 0:right, 1:up, 2:left, 3:down

    // scale to fit nicely in canvas
    const scale = 8;

    for (let i = 0; i < fib.length; i++) {
        const size = fib[i] * scale;

        // Draw quarter-circle arc for spiral
        ctx.beginPath();
        switch (angle % 4) {
            case 0: // right-down
                ctx.arc(x, y, size, Math.PI * 1.5, Math.PI * 2);
                x += size;
                y += size;
                break;
            case 1: // down-left
                ctx.arc(x, y, size, 0, Math.PI * 0.5);
                x -= size;
                y += size;
                break;
            case 2: // left-up
                ctx.arc(x, y, size, Math.PI * 0.5, Math.PI);
                x -= size;
                y -= size;
                break;
            case 3: // up-right
                ctx.arc(x, y, size, Math.PI, Math.PI * 1.5);
                x += size;
                y -= size;
                break;
        }
        ctx.strokeStyle = "#ff69b4";
        ctx.lineWidth = 2;
        ctx.stroke();
        angle++;

        // Place a sakura blossom at the end of the arc
        const blossom = document.createElement("div");
        blossom.className = "sakura";
        blossom.textContent = "ðŸŒ¸";
        blossom.style.left = `${x}px`;
        blossom.style.top = `${y}px`;
        container.appendChild(blossom);

        // Label with Fibonacci number
        const label = document.createElement("div");
        label.className = "label";
        label.textContent = fib[i];
        label.style.left = `${x}px`;
        label.style.top = `${y}px`;
        container.appendChild(label);
    }
}
